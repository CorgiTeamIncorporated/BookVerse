{% set max_stars = 5 %}
{% set max_rating = 10 %}

<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link rel="stylesheet" href="/static/bookPage.css">
        <link rel="stylesheet" href="/static/css/font-awesome.min.css">
    </head>

    <body>
        <div class="page-body">
            <div class="wrap page-container">
                <div class="main-page">
                    <div class="book-name">
                        {{ book.name }}
                    </div>

                    <div class="tag-wrap">
                        {% for tag in book.tags %}
                            <a href=# class="tag-link">#{{ tag.name }}</a>
                        {% endfor %}
                    </div>

                    <div class="information-box">
                        <img src="{{ book.cover_path }}" class="book-img">

                        <div class="information-wrap">
                            <div class="information inform-column">
                                <div class="book-topic">
                                    Информация
                                </div>

                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Автор: 
                                    </div>
                                    <div class="book-inf">
                                        {% for author in book.authors %}
                                            <a href=# class="author-link inf-link">{{ author.name }}</a>
                                        {% endfor %}
                                    </div>
                                </div>

                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Жанры: 
                                    </div>
                                    <div class="book-inf">
                                        {% for genre in book.genres %}
                                            <a href=# class="genre-link inf-link">{{ genre.name }}</a>
                                        {% endfor %}
                                    </div>
                                </div>

                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Дата публикации: 
                                    </div>
                                    <div class="book-inf inf-link">
                                        {{ book.publish_date.strftime("%d.%m.%Y") }}
                                    </div>
                                </div>

                                <!--
                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Издатель: 
                                    </div>
                                    <div class="book-inf">
                                        <a href=# class="genre-link inf-link"></a>
                                    </div>
                                </div>
                                -->

                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Входит в серии: 
                                    </div>
                                    <div class="book-inf">
                                        {% for series in book.series %}
                                            <a href=# class="series-link inf-link">{{ series.name }}</a>
                                        {% endfor %}
                                    </div>
                                </div>

                                <div class="inform-paragraph">
                                    <div class="name-par">
                                        Количество отзывов: 
                                    </div>
                                    <div class="book-inf inf-link">
                                        {{ book.reviews | length }}
                                    </div>
                                </div>
                            </div>

                            <div class="add-information inform-column">
                                <div class="book-topic">
                                    Рейтинг
                                </div>

                                <div class="rating">
                                    <div class="stars">
                                        {% set normalized_rating = book.average_rating * max_stars / max_rating %}
                                        {% set full_stars = normalized_rating | int %}
                                        {% set empty_stars = max_stars - 1 - full_stars %}
                                        {% set last_star_percent = normalized_rating % 1 * 100 %}

                                        {% for _ in range(full_stars) %}
                                            <i class="fa fa-star stars-out">
                                                <i class="fa fa-star stars-in" style="width: 100%;"></i>
                                            </i>
                                        {% endfor %}

                                        <i class="fa fa-star stars-out">
                                            <i class="fa fa-star stars-in" style="width: {{ last_star_percent }}%;"></i>
                                        </i>

                                        {% for _ in range(empty_stars) %}
                                            <i class="fa fa-star stars-out">
                                                <i class="fa fa-star stars-in" style="width: 0%;"></i>
                                            </i>
                                        {% endfor %}
                                    </div>

                                    <div class="score">
                                        {{ "%0.2f" % book.average_rating }}
                                    </div>
                                </div>

                                <div class="name-par">
                                        Награды: 
                                </div>

                                <div class="rewards-wrap">
                                    {% for award in book.awards %}
                                        <div class="reward">
                                            award.name
                                        </div>
                                    {% endfor %}
                                </div>

                                <div class="book-topic list-name">
                                    В списках у людей
                                </div>

                                <div class="bookmark-list">
                                    <div class="count-wrap">
                                        <div class="bookmark-count-wrap name-par">
                                            Количество:
                                            <div class="bookmark-count">
                                                465454
                                            </div>
                                        </div>
                                    </div>

                                    <div class="lines-wrap">
                                        <div class="line">
                                            <div class="line-back" style="width:80%"></div>
                                            <div class="line-content">
                                                <div class="line-element line-value">
                                                    11785
                                                </div>
                                                <div class="line-element line-category">
                                                    Сейчас читают
                                                </div>
                                            </div>
                                        </div>

                                        <div class="line">
                                            <div class="line-back" style="width:60%"></div>
                                            <div class="line-content">
                                                <div class="line-element line-value">
                                                    1265
                                                </div>
                                                <div class="line-element line-category">
                                                    Хотят прочитать
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="description">
                        <div class="book-topic">
                            Описание
                        </div>

                        <div class="description-text">
                            {{ book.preamble }}
                        </div>
                    </div>

                    <div class="coats-wrap">
                        <div class="book-topic">
                            Цены
                        </div>

                        <div class="shops-list">
                            {% for book_store in book.books_stores %}
                                <div class="shop-cost">
                                    <div class="shop">
                                        <a href="{{ book_store.product_url }}" class="shop-link inf-link" target="_blank">
                                            {{ book_store.store.name }}
                                        </a>                                
                                    </div>

                                    <div class="cost">
                                        {{ book_store.price[1:] }}₽
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="reviews-list">
                        <div class="book-topic">
                            Отзывы
                        </div>

                        <div class="rewiew-sort">
                            <div class="sort">
                                Сортировка:
                            </div>
                            <input class="sort-button" type="submit" value="по дате">
                            |
                            <input class="sort-button" type="submit" value="по рейтингу">
                        
                        </div>

                        <div class="rewiews-content">
                            {% for review in book.reviews %}
                                <div class="rewiew">
                                    <div class="person-inf">
                                        <div class="person-header">
                                            <div class="person-nikname">
                                                {{ review.user.login }}
                                            </div>

                                            <div class="rewiew-date">
                                                {{ review.date.strftime("%d.%m.%Y") }}
                                            </div>
                                        </div>

                                        <div class="person-book-rating">
                                            <div class="stars rewiew-stars">
                                                <i class="fa fa-star stars-out">
                                                    <i class="fa fa-star stars-in" aria-hidden="true" style="width: 100%;"></i>
                                                </i>
                                                <i class="fa fa-star stars-out">
                                                    <i class="fa fa-star stars-in" aria-hidden="true" style="width: 100%;"></i>
                                                </i>
                                                <i class="fa fa-star stars-out">
                                                    <i class="fa fa-star stars-in" aria-hidden="true" style="width: 100%;"></i>
                                                </i>
                                                <i class="fa fa-star stars-out">
                                                    <i class="fa fa-star stars-in" aria-hidden="true" style="width: 100%;"></i>
                                                </i>
                                                <i class="fa fa-star stars-out">
                                                    <i class="fa fa-star stars-in" style="width: 0%;"></i>
                                                </i>
                                            </div>

                                            <div class=" score rewiew-score">
                                                {% if review.rating %}
												    {{ review.rating.rating }}
												{% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="rewiew-text description-text">
                                        {{ review.review }}
                                    </div>
                                </div>
                            {% endfor %}

                            <div class="rewiew-input-box rewiew">
                                <div class="person-inf header-rewiew-input">
                                    <div class="leave-review">
                                        Оставьте здесь свой отзыв
                                    </div>

                                    <div class="person-book-rating">
                                        <div class="star-rating">
                                          <div class="star-rating__wrap">
                                            <input class="star-rating__input" id="star-rating-5" form="rewiew-form" type="radio" name="rating" value="5">
                                            <label class="star-rating__ico fa fa-star-o fa-lg" for="star-rating-5" title="5 out of 5 stars"></label>

                                            <input class="star-rating__input" id="star-rating-4" form="rewiew-form" type="radio" name="rating" value="4">
                                            <label class="star-rating__ico fa fa-star-o fa-lg" for="star-rating-4" title="4 out of 5 stars"></label>

                                            <input class="star-rating__input" id="star-rating-3" form="rewiew-form" type="radio" name="rating" value="3">
                                            <label class="star-rating__ico fa fa-star-o fa-lg" for="star-rating-3" title="3 out of 5 stars"></label>

                                            <input class="star-rating__input" id="star-rating-2" form="rewiew-form" type="radio" name="rating" value="2">
                                            <label class="star-rating__ico fa fa-star-o fa-lg" for="star-rating-2" title="2 out of 5 stars"></label>

                                            <input class="star-rating__input" id="star-rating-1" form="rewiew-form" type="radio" name="rating" value="1">
                                            <label class="star-rating__ico fa fa-star-o fa-lg" for="star-rating-1" title="1 out of 5 stars"></label>
                                          </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="rewiew-input-wrap">
                                    <form id="rewiew-form">
                                        <div class="textarea-wrap">
                                            <textarea class="rewiew-input" form="rewiew-form" >
                                            </textarea>
                                        </div>

                                        <input class="send-button" type="submit" value="Отправить рецензию"></input>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="blue-column">
                    <div class="author-column-wrap">
                        <div class="author-wrap">
                            <div class="column-topic">
                                Дуглас Престон
                            </div>

                            <div class="img-wrap column-img">
                                <img class="book-cover" src="">
                            </div>
                        </div>

                        <div class="author-wrap">
                            <div class="column-topic">
                                Линкольн Чайлд
                            </div>

                            <div class="img-wrap column-img">
                                <img class="book-cover" src="">
                            </div>
                        </div>

                        <div class="author-description">
                            В начале 1990-ых Престон и Чайлд создали команду, чтобы писать саспенс-романы;
                            "Реликт" был первым, потом вышли другие, включая "Разрыв" и "Молния". 
                            "Реликт" был экранизирован Парамаунт в 1997. 
                            Другие фильмы сейчас находятся в производстве в Голливудских студиях . 
                            Престон и Чайлд живут на расстоянии 500 миль друг от друга и пишут книги вместе через телефон, 
                            факс, и Интернет.
                        </div>

                        <div class="deployment-wrap">
                            <a class="deployment" href="javascript://" onclick="">Развернуть</a>
                        </div>
                    </div>    

                    <div class="author-book-wrap">
                        <a href=# class="top-link">Другие книги</a>

                        <a href=# class="author-book-link">Огонь и сера</a>
                        <a href=# class="author-book-link">Танец смерти</a>
                        <a href=# class="author-book-link">Книга мертвых</a>
                        <a href=# class="author-book-link">Белый огонь</a>
                        <a href=# class="author-book-link">Танец на кладбище</a>
                        <a class="deployment" href="javascript://" onclick="">Развернуть</a>                    
                    </div>

                    <div class="second-blue-column">
                        <div class="column-topic">
                            Другие книги серии
                        </div>

                        <div class="img-wrap column-img">
                            <a href="#">
                                <img class="book-cover" src="">
                            </a>

                            <div class="other-book-wrap">
                                <a href="#" class="otger-book-name">Реликварий</a>
                            </div>
                        </div>

                        <div class="img-wrap column-img">
                            <a href="#">
                                <img class="book-cover" src="">
                            </a>
                            <div class="other-book-wrap">
                                <a href="#" class="otger-book-name">Кабинет диковин</a>
                            </div>

                        <div class="deployment-wrap">
                            <a class="deployment" href="javascript://" onclick="">Развернуть</a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </body>
</html>
